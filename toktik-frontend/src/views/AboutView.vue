<template>
  <div class="about">
    <!-- This file is generated by Vue -->
    <h1>This is an about page</h1>
    <p>Your token: {{ token }}</p>
    <b-form @submit.prevent="onLogout">
      <b-button type="submit" variant="primary">Logout</b-button>
    </b-form>
    <b-form @submit.prevent="testButton">
      <b-button type="submit" variant="primary">Test</b-button>
    </b-form>
    
  </div>
</template>

<script>
import router from '@/router';
import { EventBus } from '@/eventBus';

export default {
  data() {
    return {
    };
  },
  setup() {
    const token = localStorage.getItem("jwt-token")
    console.log(token)
    if (token) {
      return { token: token }
    }
    return { token: 'No Token' }
  },
  methods: {
    // code for logout
    async onLogout() {
      const token = localStorage.getItem( 'jwt-token' );
      const token_refresh = localStorage.getItem( 'jwt-token-refresh' );
      if (token) {
        localStorage.removeItem('jwt-token')
        this.axios.defaults.headers.common['Authorization'] = 'Bearer ';
      }
      if (token_refresh) {
        localStorage.removeItem('jwt-token-refresh')
      }
      await router.push({ name: "Log-In" });
    },
    async testButton() {
      EventBus.$emit('show-modal', { title: 'Unauthorized', message: 'Please Log-in again'} );
    }
  }
}


</script>